{% load static %}

<article class="media content-section bg-dark text-light rounded shadow-sm mb-4 p-4">
  {% if membership.club.avatar %}
    <img src="{{ membership.club.avatar.url }}" alt="{{ membership.club.name }}"
         class="rounded-circle article-img mr-3" style="width: 50px; height: 50px;">
  {% else %}
    <img src="{% static 'digital_campus/images/default.jpg' %}" alt="Default avatar"
         class="rounded-circle article-img mr-3" style="width: 50px; height: 50px;">
  {% endif %}

  <div class="media-body">
    <div class="d-flex justify-content-between align-items-start mb-2">
      <div>
        <a href="{{ membership.club.get_absolute_url }}"><h5 class="fw-bold mb-1">{{ membership.club.name }}</h5></a>
        <p class="text-muted small mb-1">{{ membership.club.description|default:"No description" |truncatechars:100 }}</p>
        <div>
          <span class="badge badge-info text-uppercase mr-1">{{ membership.role }}</span>
          <span class="badge badge-light">{{ membership.club.club_membership_set.count }} members</span>
          <span class="badge badge-primary">{{ membership.club.events_owned.count }} events</span>
        </div>
      </div>

      <div class="dropdown">
        <button class="btn btn-sm btn-outline-light dropdown-toggle" type="button" data-toggle="dropdown">
          <i class="bi bi-three-dots-vertical"></i>
        </button>
        <div class="dropdown-menu custom-dropdown-menu dropdown-menu-right">
          <a class="dropdown-item" href="{{ membership.club.get_absolute_url }}">
            <i class="bi bi-eye mr-2"></i> View Club
          </a>
          {% if membership.role == "owner" %}

            <a class="dropdown-item text-light" href="{% url 'events:event-create' %}?club={{ membership.club.pk }}">
              <i class="bi bi-calendar-plus mr-2"></i> New Event
            </a>

            <a class="dropdown-item text-light" href="{% url 'posts:post-create' %}?club={{ membership.club.pk }}">
              <i class="bi bi-pencil-square mr-2"></i> New Post
            </a>

            <a class="dropdown-item" href="{{ membership.club.get_absolute_url }}settings/">
              <i class="bi bi-tools mr-2"></i> Manage Club
            </a>
            <button class="dropdown-item text-danger" onclick="openDeleteModal('{{ membership.club.slug }}', '{{ membership.club.name }}')">
              <i class="bi bi-trash mr-2"></i> Delete Club
            </button>
          {% else %}
            <button class="dropdown-item text-danger" onclick="openLeaveModal('{{ membership.club.slug }}', '{{ membership.club.name }}')">
              <i class="bi bi-box-arrow-left mr-2"></i> Leave Club
            </button>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</article>
